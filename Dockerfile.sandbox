# Sandbox container for executing generated code safely
# This container runs with strict resource limits and isolation

FROM python:3.11-slim

WORKDIR /sandbox

# Install common scientific Python packages
RUN pip install --no-cache-dir \
    numpy \
    pandas \
    scipy \
    matplotlib \
    seaborn \
    scikit-learn \
    torch \
    torchvision \
    torchaudio \
    transformers \
    pillow \
    networkx \
    pytest \
    && rm -rf ~/.cache/pip

# Create non-root user
RUN useradd -m -u 1000 -s /bin/bash sandbox \
    && mkdir -p /sandbox/work /sandbox/output \
    && chown -R sandbox:sandbox /sandbox

# Switch to non-root user
USER sandbox

# Set environment
ENV PYTHONUNBUFFERED=1 \
    MPLBACKEND=Agg \
    HOME=/sandbox

WORKDIR /sandbox/work

# Default command
CMD ["python"]
